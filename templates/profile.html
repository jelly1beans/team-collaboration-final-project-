<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Profile</title>
  <link rel="stylesheet" href="{{url_for('static', filename = 'pstyle.css')}}">
</head>
<body>
  <div class="container">
    <!-- Profile Section -->
    <div class="profile-section">
      <div class="profile-icon">
        <img id="profileImage" src="https://img.icons8.com/ios-filled/100/FFFFFF/user.png" alt="User">
      </div>
      <!-- Hidden input with styled label -->
      <input type="file" id="uploadImage" accept="image/*">
      <label for="uploadImage" class="upload-btn">Change Picture</label>

      <h2>PROFILE</h2>

      <div class="actions">
        <button id="deleteBtn">Delete</button>
        <button id="updateBtn">Update</button>
        <button id="addBtn">Add Contact</button>
      </div>
    </div>

    <!-- Details Section -->
    <div class="details-section">
      <div class="input-box">
        <label>Name (Full Name):</label>
        <input type="text" id="name" value="Juan Dela Cruz">
      </div>
      <div class="input-box">
        <label>Contact number:</label>
        <input type="text" id="contact" value="+63 912 345 6789">
      </div>
      <div class="input-box">
        <label>Email:</label>
        <input type="email" id="email" value="juan.delacruz@email.com">
      </div>

      <!-- Booked Appointments -->
      <div class="appointments">
        <div class="appt-header">Booked Appointments:</div>
        <div class="appt-list" id="appointmentsList">
          <p>Appointment 1 <button class="cancel-btn">Cancel</button></p>
          <p>Appointment 2 <button class="cancel-btn">Cancel</button></p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Profile Picture Preview
    const uploadInput = document.getElementById('uploadImage');
    const profileImg = document.getElementById('profileImage');

    uploadInput.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          profileImg.src = e.target.result;
          localStorage.setItem("profilePic", e.target.result);
        };
        reader.readAsDataURL(file);
      }
    });

    // Load saved profile pic from localStorage
    window.addEventListener("load", () => {
      const savedPic = localStorage.getItem("profilePic");
      if (savedPic) {
        profileImg.src = savedPic;
      }
    });

    // Buttons
    document.getElementById("updateBtn").addEventListener("click", () => {
      const name = document.getElementById("name").value;
      const contact = document.getElementById("contact").value;
      const email = document.getElementById("email").value;

      localStorage.setItem("name", name);
      localStorage.setItem("contact", contact);
      localStorage.setItem("email", email);

      alert("Profile updated successfully!");
    });

    document.getElementById("deleteBtn").addEventListener("click", () => {
      if (confirm("Are you sure you want to delete this profile?")) {
        localStorage.clear();
        document.getElementById("name").value = "";
        document.getElementById("contact").value = "";
        document.getElementById("email").value = "";
        profileImg.src = "https://img.icons8.com/ios-filled/100/FFFFFF/user.png";
        alert("Profile deleted.");
      }
    });

    document.getElementById("addBtn").addEventListener("click", () => {
      const contact = prompt("Enter new contact number:");
      if (contact) {
        alert("New contact added: " + contact);
      }
    });

    // Load saved profile info
    window.addEventListener("load", () => {
      if (localStorage.getItem("name")) {
        document.getElementById("name").value = localStorage.getItem("name");
      }
      if (localStorage.getItem("contact")) {
        document.getElementById("contact").value = localStorage.getItem("contact");
      }
      if (localStorage.getItem("email")) {
        document.getElementById("email").value = localStorage.getItem("email");
      }
    });
  </script>
</body>
</html>
